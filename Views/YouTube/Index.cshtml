@{
    ViewData["Title"] = "YouTube Topic Explorer";
    var videos = ViewBag.Videos as List<YouTubeSearchItem>;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>@ViewData["Title"]</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet" />

    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #4e54c8, #8f94fb);
            min-height: 100vh;
        }

        .navbar-custom {
            background: transparent;
            backdrop-filter: blur(10px);
        }

        .navbar-brand {
            font-weight: bold;
            color: #fff !important;
        }

        .nav-link {
            color: #eee !important;
            font-weight: 500;
        }

            .nav-link:hover {
                color: #ffffff !important;
                text-decoration: underline;
            }

        .wrapper {
            background-color: rgba(255, 255, 255, 0.92);
            border-radius: 20px;
            max-width: 800px;
            margin: 80px auto 40px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-weight: 700;
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }

        label {
            font-weight: 600;
            color: #444;
        }

        .btn-gradient {
            background: linear-gradient(to right, #4facfe, #6a82fb);
            border: none;
            color: white;
            font-weight: bold;
            padding: 0.6rem 0;
            border-radius: 8px;
            transition: all 0.3s ease-in-out;
        }

            .btn-gradient:hover {
                background: linear-gradient(to right, #6a82fb, #4facfe);
            }

        .video-card {
            display: flex;
            background-color: #f7f9ff;
            border-radius: 14px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.07);
        }

            .video-card:hover {
                transform: scale(1.01);
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
            }

            .video-card img {
                width: 200px;
                object-fit: cover;
            }

        .video-info {
            padding: 15px;
            flex: 1;
        }

            .video-info h5 {
                color: #2b2d42;
                margin-bottom: 10px;
            }

        footer {
            text-align: center;
            color: #ddd;
            font-size: 0.85rem;
            margin-bottom: 20px;
        }

        #loaderOverlay {
            position: fixed;
            z-index: 9999;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            text-align: center;
            font-family: 'Segoe UI', sans-serif;
            padding: 2rem;
        }

        .loader-content {
            max-width: 90%;
        }

            .loader-content p {
                margin-top: 20px;
                font-size: 1.1rem;
                line-height: 1.6;
            }

    </style>
</head>
<body>
    <div id="loaderOverlay" style="display:none;">
        <div class="loader-content">
            <div class="spinner-border text-light" role="status"></div>
            <p>Fetching videos based on your interest.<br />Please hold tight ⏳✨</p>
        </div>
    </div>
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom shadow-sm px-4">
        <a class="navbar-brand" href="#">YouTubeTrendingOutliers</a>
         <div class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link text-warning" asp-controller="Auth" asp-action="Logout">Logout</a>
                </li>
                @if (User.Identity?.IsAuthenticated ?? false)
                {
                    <li class="nav-item me-3">
                        <span class="nav-link disabled text-light">Hello, @User.Identity.Name</span>
                    </li>
                }
            </ul>
        </div> 
    </nav>

    <!-- Main Content -->
    <div class="wrapper">
        <h1>📺 YouTube Topic Explorer</h1>

        <form method="post" class="mb-4">
            <div class="mb-3">
                <label>🔍 Search Topic</label>
                <input type="text" name="topic" class="form-control" placeholder="e.g. Ghibli music, Coding tutorials" required />
            </div>
            <div class="mb-3">
                <label>🌍 Select Region</label>
                <select name="regionCode" class="form-select" required>
                    <option value="">-- Select Country --</option>
                    <option value="US">🇺🇸 United States</option>
                    <option value="IN">🇮🇳 India</option>
                    <option value="JP">🇯🇵 Japan</option>
                    <option value="GB">🇬🇧 United Kingdom</option>
                    <option value="CA">🇨🇦 Canada</option>
                    <option value="DE">🇩🇪 Germany</option>
                    <option value="FR">🇫🇷 France</option>
                    <option value="KR">🇰🇷 South Korea</option>
                    <option value="BR">🇧🇷 Brazil</option>
                    <option value="AU">🇦🇺 Australia</option>
                    <option value="RU">🇷🇺 Russia</option>
                    <option value="MX">🇲🇽 Mexico</option>
                    <option value="ZA">🇿🇦 South Africa</option>
                </select>
            </div>
            <button type="submit" class="btn btn-gradient w-100 mt-3">✨ Fetch Videos</button>
        </form>

        @if (ViewBag.Error != null)
        {
            <div class="alert alert-danger">@ViewBag.Error</div>
        }

        @if (ViewBag.Videos != null && (ViewBag.Videos as List<VideoItem>).Count > 0)
        {
            <h4 class="mt-4">📈 Top 50 Outlier Videos</h4>
            @foreach (var video in (List<VideoItem>)ViewBag.Videos)
            {
                <div class="video-card">
                    <img src="@video.Snippet.Thumbnails?.Medium?.Url" />
                    <div class="video-info">
                        <h5>@video.Snippet.Title</h5>
                        <p><strong>Views:</strong> @video.Statistics?.ViewCount</p>
                        <p><strong>Channel:</strong> @video.Snippet.ChannelTitle</p>
                        <a href="https://www.youtube.com/watch?v=@video.Id" target="_blank" class="btn btn-sm btn-outline-primary mt-2">📺 Watch</a>
                    </div>
                </div>
            }
        }
    </div>

    <!-- Footer -->
    <footer>
        &copy; @DateTime.Now.Year - YouTube Topic Explorer | Built with 💜
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<script>
    document.querySelector("form").addEventListener("submit", function () {
        document.getElementById("loaderOverlay").style.display = "flex";
    });
</script>